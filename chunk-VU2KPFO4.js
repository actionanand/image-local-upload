import{a as fe}from"./chunk-KSEQL7HZ.js";import{a as me,b as L,c as pe}from"./chunk-UE2SYMQH.js";import{A as D,B as oe,C as se,D as F,E as _,F as c,G as ae,H as U,I as d,J as y,K as O,M as z,N as le,O as ce,P as de,S as P,T as k,U as ue,Y as he,_ as N,a as te,b as ne,c as M,g as Y,h as J,i as ie,j as v,k as u,l as h,p as A,q as l,r as w,s as ee,t as re,u as x,v as S,w as R,x as p,y as s,z as a}from"./chunk-3FBWLJSC.js";var ye={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},st=ne(te({},ye),{"[class.ng-submitted]":"isSubmitted"});var Ce=new ie("",{providedIn:"root",factory:()=>ge}),ge="always";var be=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=ee({type:r});static \u0275inj=J({})}return r})();var _e=(()=>{class r{static withConfig(e){return{ngModule:r,providers:[{provide:Ce,useValue:e.callSetDisabledState??ge}]}}static \u0275fac=function(n){return new(n||r)};static \u0275mod=ee({type:r});static \u0275inj=J({imports:[be]})}return r})();function Ve(r,t){if(r&1){let e=F();s(0,"div",1),_("click",function(){let i=u(e).$implicit,o=c();return h(o.selectQuality(i.value))})("keydown",function(i){let o=u(e),m=o.$implicit,f=o.index,g=c();return h(g.onOptionKeydown(i,m.value,f))}),D(1,"div",2),s(2,"div",3)(3,"span",4),d(4),a(),s(5,"span",5),d(6),a()()()}if(r&2){let e=t.$implicit,n=t.index,i=c();U("selected",i.selectedQuality===e.value),p("tabindex",i.selectedQuality===e.value?0:-1),R("aria-checked",i.selectedQuality===e.value)("id","quality-option-"+n),l(4),y(e.label),l(2),y(e.description)}}var $=class r{showSelector=!1;selectedQuality="original";qualitySelected=new S;qualityOptions=[{value:"original",label:"Original",description:"Keep the original image quality"},{value:"optimized",label:"Optimized",description:"Good quality with moderate file size reduction"},{value:"medium",label:"Medium",description:"Medium quality with better compression"},{value:"low",label:"Low",description:"Low quality with maximum compression"}];onOptionKeydown(t,e,n){if(t.key==="Enter"||t.key===" "){t.preventDefault(),this.selectQuality(e);return}let i=-1;if(t.key==="ArrowDown"||t.key==="ArrowRight"?(t.preventDefault(),i=(n+1)%this.qualityOptions.length):(t.key==="ArrowUp"||t.key==="ArrowLeft")&&(t.preventDefault(),i=(n-1+this.qualityOptions.length)%this.qualityOptions.length),i>=0){let o=document.getElementById(`quality-option-${i}`);o&&(o.focus(),this.selectQuality(this.qualityOptions[i].value))}}focusSelectedOption(){setTimeout(()=>{let t=this.qualityOptions.findIndex(e=>e.value===this.selectedQuality);if(t>=0){let e=document.getElementById(`quality-option-${t}`);e&&e.focus()}},0)}selectQuality(t){this.selectedQuality=t,this.qualitySelected.emit(t)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=w({type:r,selectors:[["app-image-quality-selector"]],inputs:{showSelector:"showSelector",selectedQuality:"selectedQuality"},outputs:{qualitySelected:"qualitySelected"},decls:1,vars:1,consts:[["class","quality-option","role","radio",3,"selected","tabindex","click","keydown",4,"ngFor","ngForOf"],["role","radio",1,"quality-option",3,"click","keydown","tabindex"],[1,"option-radio"],[1,"option-details"],[1,"option-label"],[1,"option-description"]],template:function(e,n){e&1&&x(0,Ve,7,7,"div",0),e&2&&p("ngForOf",n.qualityOptions)},dependencies:[P,_e],styles:['.quality-selector-container[_ngcontent-%COMP%]{margin-top:15px;padding:15px;background-color:#f8f9fa;border-radius:6px;border:1px solid #e9ecef}h4[_ngcontent-%COMP%]{margin-top:0;margin-bottom:10px;font-size:16px;color:#333}.quality-options[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.quality-option[_ngcontent-%COMP%]{display:flex;align-items:center;padding:8px;border-radius:4px;cursor:pointer;transition:background-color .2s}.quality-option[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.quality-option.selected[_ngcontent-%COMP%]{background-color:#e3f2fd}.option-radio[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%;border:2px solid #adb5bd;margin-right:10px;display:flex;align-items:center;justify-content:center}.selected[_ngcontent-%COMP%]   .option-radio[_ngcontent-%COMP%]:after{content:"";width:10px;height:10px;border-radius:50%;background-color:#06c}.option-details[_ngcontent-%COMP%]{display:flex;flex-direction:column}.option-label[_ngcontent-%COMP%]{font-weight:500}.option-description[_ngcontent-%COMP%]{font-size:12px;color:#6c757d;margin-top:3px}.quality-option[_ngcontent-%COMP%]:focus{outline:2px solid #0066cc;outline-offset:2px}.confirm-btn[_ngcontent-%COMP%]:focus, .cancel-btn[_ngcontent-%COMP%]:focus{outline:2px solid #0066cc;outline-offset:2px;box-shadow:0 0 0 3px #0066cc4d}']})};var W=class r{transform(t){if(t==null||t===0)return"0 Bytes";let e=1024,n=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,i)).toFixed(2))+" "+n[i]}static \u0275fac=function(e){return new(e||r)};static \u0275pipe=re({name:"fileSize",type:r,pure:!0})};function Me(r,t){if(r&1){let e=F();oe(0),s(1,"div",4)(2,"label",5)(3,"span",6),d(4,"+"),a(),s(5,"span",7),d(6,"Select image to upload"),a(),s(7,"span",8),d(8),a()(),s(9,"input",9),_("change",function(i){u(e);let o=c();return h(o.onFileSelected(i))}),a()(),se()}if(r&2){let e=c();l(8),O("Maximum file size: ",e.MAX_FILE_SIZE_MB," MB"),l(),p("disabled",e.isUploading)}}function we(r,t){if(r&1){let e=F();s(0,"div",10)(1,"div",11),D(2,"img",12),a(),s(3,"div",13)(4,"span",14),d(5),a(),s(6,"span",15),d(7),z(8,"fileSize"),a()(),s(9,"app-image-quality-selector",16),_("qualitySelected",function(i){u(e);let o=c();return h(o.onQualitySelected(i))}),a(),s(10,"div",17)(11,"button",18),_("click",function(){u(e);let i=c();return h(i.cancelUpload())}),d(12,"Cancel"),a(),s(13,"button",19),_("click",function(){u(e);let i=c();return h(i.uploadImage())}),d(14),a()()()}if(r&2){let e=c();l(2),p("src",e.previewUrl,A),l(3),y(e.selectedFile==null?null:e.selectedFile.name),l(2),y(le(8,8,e.selectedFile==null?null:e.selectedFile.size)),l(2),p("showSelector",!0)("selectedQuality",e.selectedQuality),l(4),p("disabled",e.isUploading),R("aria-label",e.isUploading?"Currently uploading":"Upload image"),l(),O(" ",e.isUploading?"Uploading...":"Upload"," ")}}function xe(r,t){if(r&1&&(s(0,"div",20),d(1),a()),r&2){let e=c();l(),y(e.errorMessage)}}var Q=class r{isUploading=!1;errorMessage="";selectedFile=null;previewUrl=null;selectedQuality="original";MAX_FILE_SIZE_MB=me.MAX_FILE_SIZE_MB||5;MAX_FILE_SIZE_BYTES=this.MAX_FILE_SIZE_MB*1024*1024;imageService=v(L);imageQualityService=v(pe);toastService=v(N);onFileSelected(t){let e=t.target;if(!e.files?.length)return;let n=e.files[0];if(n.size>this.MAX_FILE_SIZE_BYTES){this.errorMessage=`File is too large. Maximum size is ${this.MAX_FILE_SIZE_MB} MB.`,e.value="";return}if(!n.type.startsWith("image/")){this.errorMessage="Please select an image file";return}this.errorMessage="",this.selectedFile=n,this.createPreview(n)}createPreview(t){let e=new FileReader;e.onload=n=>{this.previewUrl=n.target?.result},e.readAsDataURL(t)}onQualitySelected(t){this.selectedQuality=t}uploadImage(){return M(this,null,function*(){if(this.selectedFile){this.isUploading=!0;try{let t=yield this.imageQualityService.reduceImageQuality(this.selectedFile,this.selectedQuality);if(yield this.imageService.uploadImage({file:this.selectedFile,base64:t.base64,quality:this.selectedQuality,originalSize:t.originalSize,reducedSize:t.reducedSize,compressionRatio:t.compressionRatio})){let n=this.imageQualityService.formatFileSize(t.originalSize),i=this.imageQualityService.formatFileSize(t.reducedSize);if(this.selectedQuality!=="original"){let o=((1-t.compressionRatio)*100).toFixed(0);this.toastService.success(`Image uploaded! Size reduced from ${n} to ${i} (${o}% saved)`)}else this.toastService.success(`Image uploaded! Size: ${n}`)}this.resetForm()}catch(t){console.error("Upload error:",t),this.errorMessage="Failed to upload image",this.toastService.error("Failed to upload image")}finally{this.isUploading=!1}}})}cancelUpload(){this.resetForm()}resetForm(){this.selectedFile=null,this.previewUrl=null,this.selectedQuality="original",this.errorMessage="";let t=document.getElementById("file-input");t&&(t.value="")}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=w({type:r,selectors:[["app-image-upload"]],decls:7,vars:3,consts:[["fileSelected",""],[1,"upload-container"],[4,"ngIf","ngIfElse"],["class","error-message",4,"ngIf"],[1,"upload-area"],["for","file-input",1,"upload-label"],[1,"upload-icon"],[1,"upload-text"],[1,"upload-hint"],["type","file","id","file-input","accept","image/*",3,"change","disabled"],[1,"selected-file"],[1,"preview-container"],["alt","Preview",1,"image-preview",3,"src"],[1,"file-info"],[1,"file-name"],[1,"file-size"],[3,"qualitySelected","showSelector","selectedQuality"],[1,"action-buttons"],["tabindex","0","aria-label","Cancel upload",1,"btn","btn-cancel",3,"click"],["tabindex","0",1,"btn","btn-upload",3,"click","disabled"],[1,"error-message"]],template:function(e,n){if(e&1&&(s(0,"div",1)(1,"h2"),d(2,"Upload Image"),a(),x(3,Me,10,2,"ng-container",2)(4,we,15,10,"ng-template",null,0,de)(6,xe,2,1,"div",3),a()),e&2){let i=ae(5);l(3),p("ngIf",!n.selectedFile)("ngIfElse",i),l(3),p("ngIf",n.errorMessage)}},dependencies:[k,$,W],styles:[".action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:24px}.btn[_ngcontent-%COMP%]{padding:10px 20px;border-radius:4px;font-weight:500;font-size:14px;cursor:pointer;transition:all .2s ease;border:none;min-width:100px;box-shadow:0 2px 4px #0000001a}.btn-cancel[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#666;border:1px solid #e0e0e0}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.btn-cancel[_ngcontent-%COMP%]:active{background-color:#d5d5d5;transform:translateY(1px)}.btn-upload[_ngcontent-%COMP%]{background-color:#06c;color:#fff}.btn-upload[_ngcontent-%COMP%]:hover{background-color:#0055b3}.btn-upload[_ngcontent-%COMP%]:active{background-color:#049;transform:translateY(1px)}.btn-upload[_ngcontent-%COMP%]:disabled{background-color:#80b3e6;cursor:not-allowed;box-shadow:none}@media (max-width: 600px){.action-buttons[_ngcontent-%COMP%]{flex-direction:column;width:100%}.btn[_ngcontent-%COMP%]{width:100%}}.upload-label[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.upload-text[_ngcontent-%COMP%]{font-size:16px;margin-bottom:8px}.upload-hint[_ngcontent-%COMP%]{font-size:12px;color:#666;margin-top:8px}.error-message[_ngcontent-%COMP%]{color:#d32f2f;background-color:#ffebee;padding:10px;border-radius:4px;margin-top:10px;font-size:14px;text-align:center}"]})};var B=class r{convertImage(t,e){return M(this,null,function*(){try{let n=yield this.createImageFromBase64(t),i=this.getMimeType(e);return e==="gif"?yield this.convertToOptimizedFormat(n,e,i,!0):yield this.convertToOptimizedFormat(n,e,i,!1)}catch(n){throw console.error("Conversion error:",n),new Error("Failed to convert image: "+(n instanceof Error?n.message:"Unknown error"))}})}getMimeType(t){switch(t){case"jpeg":return"image/jpeg";case"png":return"image/png";case"webp":return"image/webp";case"gif":return"image/gif";default:return"image/jpeg"}}createImageFromBase64(t){return new Promise((e,n)=>{let i=new Image;i.onload=()=>e(i),i.onerror=n,i.src=t})}convertToFormat(t,e,n){return new Promise((i,o)=>{try{let m=document.createElement("canvas"),f=m.getContext("2d");if(!f){o(new Error("Could not get canvas context"));return}m.width=t.width,m.height=t.height,f.drawImage(t,0,0),m.toBlob(g=>{if(!g){o(new Error("Failed to convert image"));return}let C=new FileReader;C.onloadend=()=>{i({blob:g,base64:C.result})},C.onerror=o,C.readAsDataURL(g)},n)}catch(m){o(m)}})}getFormatFromMimeType(t){return t.includes("jpeg")||t.includes("jpg")?"jpeg":t.includes("png")?"png":t.includes("webp")?"webp":t.includes("gif")?"gif":"jpeg"}getExtensionFromFormat(t){switch(t){case"jpeg":return"jpg";default:return t}}convertImageWithReducedQuality(t,e,n){return M(this,null,function*(){let i=yield this.createImageFromBase64(t),o=.8,m=1,f,g=0,C=5;do{g>0&&(o=Math.max(.1,o-.15),g>2&&(m=m*.8));let V=document.createElement("canvas"),j=V.getContext("2d");if(!j)throw new Error("Could not get canvas context");V.width=Math.floor(i.width*m),V.height=Math.floor(i.height*m),j.drawImage(i,0,0,V.width,V.height);let X=this.getMimeType(e);f=yield new Promise((T,E)=>{V.toBlob(b=>{if(!b){E(new Error("Failed to convert image"));return}let H=new FileReader;H.onload=()=>{T({blob:b,base64:H.result})},H.onerror=E,H.readAsDataURL(b)},X,o)}),g++}while(f.blob.size>n&&g<C);let G=Math.ceil(t.length*3/4);return{blob:f.blob,base64:f.base64,originalSize:G,convertedSize:f.blob.size,format:e,mimeType:this.getMimeType(e)}})}convertToOptimizedFormat(t,e,n,i){return M(this,null,function*(){let o=i?300:1200,m=i?.7:.9,f=t.width,g=t.height;(f>o||g>o)&&(f>g?(g=Math.round(g*(o/f)),f=o):(f=Math.round(f*(o/g)),g=o));let C=document.createElement("canvas");C.width=f,C.height=g;let G=C.getContext("2d");if(!G)throw new Error("Could not get canvas context");G.drawImage(t,0,0,f,g);let V=yield new Promise((T,E)=>{C.toBlob(b=>{b?T(b):E(new Error("Failed to create blob"))},n,m)}),j=yield new Promise((T,E)=>{let b=new FileReader;b.onload=()=>T(b.result),b.onerror=E,b.readAsDataURL(V)}),X=new Blob([t.src]).size;return{blob:V,base64:j,originalSize:X,convertedSize:V.size,format:e,mimeType:n}})}static \u0275fac=function(e){return new(e||r)};static \u0275prov=Y({token:r,factory:r.\u0275fac,providedIn:"root"})};function De(r,t){if(r&1){let e=F();s(0,"button",15),_("click",function(){let i=u(e).$implicit,o=c(2);return h(o.selectFormat(i.value))})("keyup.enter",function(){let i=u(e).$implicit,o=c(2);return h(o.selectFormat(i.value))}),s(1,"span",16),d(2),a(),s(3,"span",17),d(4),a()()}if(r&2){let e=t.$implicit,n=c(2);U("selected",n.selectedFormat===e.value)("disabled",n.isCurrentFormat(e.value)||n.isConverting),p("disabled",n.isCurrentFormat(e.value)||n.isConverting),l(2),y(e.icon),l(2),y(e.label)}}function Fe(r,t){if(r&1){let e=F();s(0,"div",1),_("click",function(i){u(e);let o=c();return h(o.closeModal(i))})("keyup.enter",function(i){u(e);let o=c();return h(o.closeModal(i))}),s(1,"div",2)(2,"div",3)(3,"h3"),d(4,"Convert Image Format"),a(),s(5,"button",4),_("click",function(){u(e);let i=c();return h(i.onClose())})("keyup.enter",function(){u(e);let i=c();return h(i.onClose())}),d(6,"\xD7"),a()(),s(7,"div",5)(8,"div",6),D(9,"img",7),a(),s(10,"div",8)(11,"p",9),d(12),a(),s(13,"h4"),d(14,"Convert to:"),a(),s(15,"div",10),x(16,De,5,7,"button",11),a()()(),s(17,"div",12)(18,"button",13),_("click",function(){u(e);let i=c();return h(i.onClose())})("keyup.enter",function(){u(e);let i=c();return h(i.onClose())}),d(19,"Cancel"),a(),s(20,"button",14),_("click",function(){u(e);let i=c();return h(i.convertImage())})("keyup.enter",function(){u(e);let i=c();return h(i.convertImage())}),d(21),a()()()()}if(r&2){let e=c();l(9),p("src",e.image==null?null:e.image.base64,A)("alt",e.image==null?null:e.image.name),l(3),O("Current format: ",e.getCurrentFormat()),l(4),p("ngForOf",e.availableFormats),l(4),p("disabled",!e.selectedFormat||e.isConverting||e.isCurrentFormat(e.selectedFormat)),l(),O(" ",e.isConverting?"Converting...":"Convert"," ")}}var Z=class r{isOpen=!1;image=null;close=new S;converted=new S;selectedFormat=null;isConverting=!1;availableFormats=[{value:"jpeg",label:"JPEG",icon:"\u{1F5BC}\uFE0F"},{value:"png",label:"PNG",icon:"\u{1F4CA}"},{value:"webp",label:"WebP",icon:"\u{1F310}"},{value:"gif",label:"GIF",icon:"\u{1F3AD}"}];imageConverter=v(B);imageConverterService=v(B);toastService=v(N);getCurrentFormat(){return this.image?this.imageConverter.getFormatFromMimeType(this.image.type).toUpperCase():""}isCurrentFormat(t){return this.image?this.imageConverter.getFormatFromMimeType(this.image.type)===t:!1}selectFormat(t){this.selectedFormat=t}closeModal(t){t.target.classList.contains("modal-overlay")&&this.close.emit()}onClose(){this.close.emit()}convertImage(){return M(this,null,function*(){if(!(!this.image||!this.selectedFormat||this.isConverting)){this.isConverting=!0;try{let t=yield this.imageConverterService.convertImage(this.image.base64,this.selectedFormat),e={id:Date.now().toString(),name:this.generateNewFilename(this.image.name,this.selectedFormat),base64:t.base64,type:t.mimeType,date:new Date,originalSize:t.originalSize,reducedSize:t.convertedSize,quality:"original",compressionRatio:t.convertedSize/t.originalSize};this.converted.emit(e),this.close.emit()}catch(t){console.error("Error during conversion:",t),this.toastService.error("Failed to convert image format"),this.close.emit()}finally{this.isConverting=!1}}})}formatSize(t){if(t===0)return"0 Bytes";let e=1024,n=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,i)).toFixed(2))+" "+n[i]}generateNewFilename(t,e){let n=t.substring(0,t.lastIndexOf("."))||t,i=this.imageConverter.getExtensionFromFormat(e);return`${n}-converted.${i}`}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=w({type:r,selectors:[["app-format-conversion-modal"]],inputs:{isOpen:"isOpen",image:"image"},outputs:{close:"close",converted:"converted"},decls:1,vars:1,consts:[["class","modal-overlay","tabindex","0",3,"click","keyup.enter",4,"ngIf"],["tabindex","0",1,"modal-overlay",3,"click","keyup.enter"],[1,"modal-content"],[1,"modal-header"],[1,"close-btn",3,"click","keyup.enter"],[1,"modal-body"],[1,"image-preview"],[3,"src","alt"],[1,"format-options"],[1,"info-text"],[1,"format-grid"],["class","format-btn",3,"selected","disabled","click","keyup.enter",4,"ngFor","ngForOf"],[1,"modal-footer"],[1,"btn-cancel",3,"click","keyup.enter"],[1,"btn-convert",3,"click","keyup.enter","disabled"],[1,"format-btn",3,"click","keyup.enter","disabled"],[1,"format-icon"],[1,"format-label"]],template:function(e,n){e&1&&x(0,Fe,22,6,"div",0),e&2&&p("ngIf",n.isOpen)},dependencies:[k,P],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;width:100%;max-width:500px;max-height:90vh;overflow-y:auto;box-shadow:0 5px 15px #0000004d}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;border-bottom:1px solid #e0e0e0}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px}.close-btn[_ngcontent-%COMP%]{background:transparent;border:none;font-size:24px;cursor:pointer;color:#666}.modal-body[_ngcontent-%COMP%]{padding:20px}.image-preview[_ngcontent-%COMP%]{margin-bottom:20px;text-align:center}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:200px;border-radius:4px}.format-options[_ngcontent-%COMP%]{margin-top:15px}.info-text[_ngcontent-%COMP%]{margin-bottom:10px;color:#666}.format-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:10px}.format-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:15px;border:1px solid #e0e0e0;border-radius:4px;background:#f9f9f9;cursor:pointer;transition:all .2s}.format-btn[_ngcontent-%COMP%]:hover:not(.disabled){background:#f0f0f0;border-color:#ccc}.format-btn.selected[_ngcontent-%COMP%]{background:#e3f2fd;border-color:#90caf9}.format-btn.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:default}.format-icon[_ngcontent-%COMP%]{font-size:24px;margin-bottom:5px}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:15px 20px;border-top:1px solid #e0e0e0;gap:10px}.btn-cancel[_ngcontent-%COMP%]{padding:8px 16px;background:#f5f5f5;border:1px solid #ddd;border-radius:4px;cursor:pointer;color:#333}.btn-convert[_ngcontent-%COMP%]{padding:8px 16px;background:#06c;color:#fff;border:none;border-radius:4px;cursor:pointer}.btn-convert[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:default}"]})};function Ie(r,t){r&1&&(s(0,"div",5),d(1,"No images uploaded yet"),a())}function Ee(r,t){if(r&1){let e=F();s(0,"div",6)(1,"div",7),_("click",function(){let i=u(e).$implicit,o=c();return h(o.openInNewWindow(i))})("keyup",function(i){let o=u(e).$implicit,m=c();return h(m.onImagePreviewKeyup(i,o))}),D(2,"img",8),a(),s(3,"div",9)(4,"div",10),d(5),a(),s(6,"div",11),d(7),z(8,"date"),a(),s(9,"div",12)(10,"button",13),_("click",function(i){let o=u(e).$implicit,m=c();return h(m.openFormatConversion(o,i))}),d(11,"Convert"),a(),s(12,"button",14),_("click",function(i){let o=u(e).$implicit,m=c();return h(m.deleteImage(o.id,i))}),d(13,"Delete"),a()()()()}if(r&2){let e=t.$implicit;l(2),p("src",e.base64,A)("alt",e.name),l(3),y(e.name),l(2),y(ce(8,4,e.date,"short"))}}var K=class r{images=[];imageService=v(L);confirmationService=v(fe);toastService=v(N);router=v(he);isConversionModalOpen=!1;selectedImageForConversion=null;ngOnInit(){this.imageService.images$.subscribe(t=>{this.images=t})}openInNewWindow(t){let e=this.router.createUrlTree(["/detail",t.id]),n=window.location.origin+this.router.serializeUrl(e);window.open(n,"_blank")}deleteImage(t,e){return M(this,null,function*(){e.stopPropagation(),(yield this.confirmationService.confirm("Are you sure you want to delete this image?"))&&(this.imageService.deleteImage(t),this.toastService.success("Image deleted successfully"))})}openFormatConversion(t,e){e.stopPropagation(),this.selectedImageForConversion=t,this.isConversionModalOpen=!0}closeFormatConversion(){this.isConversionModalOpen=!1,this.selectedImageForConversion=null}onImageConverted(t){this.imageService.addConvertedImage(t)&&(t.quality==="medium"?this.toastService.success("Image converted and resized to fit storage limits"):this.toastService.success(`Image converted to ${t.type.split("/")[1].toUpperCase()}`)),this.closeFormatConversion()}onImagePreviewKeyup(t,e){(t.key==="Enter"||t.key===" ")&&this.openInNewWindow(e)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=w({type:r,selectors:[["app-image-gallery"]],decls:7,vars:4,consts:[[1,"gallery-container"],["class","empty-gallery",4,"ngIf"],[1,"image-grid"],["class","image-card",4,"ngFor","ngForOf"],[3,"close","converted","isOpen","image"],[1,"empty-gallery"],[1,"image-card"],["tabindex","0","role","button","aria-label","Open image in new window",1,"image-preview",3,"click","keyup"],[3,"src","alt"],[1,"image-info"],[1,"image-name"],[1,"image-date"],[1,"action-buttons"],[1,"convert-btn",3,"click"],[1,"delete-btn",3,"click"]],template:function(e,n){e&1&&(s(0,"div",0)(1,"h2"),d(2,"Image Gallery"),a(),x(3,Ie,2,0,"div",1),s(4,"div",2),x(5,Ee,14,7,"div",3),a()(),s(6,"app-format-conversion-modal",4),_("close",function(){return n.closeFormatConversion()})("converted",function(o){return n.onImageConverted(o)}),a()),e&2&&(l(3),p("ngIf",n.images.length===0),l(2),p("ngForOf",n.images),l(),p("isOpen",n.isConversionModalOpen)("image",n.selectedImageForConversion))},dependencies:[k,P,ue,Z],styles:[".action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:10px}.convert-btn[_ngcontent-%COMP%]{background:#06c;color:#fff;border:none;padding:5px 10px;border-radius:4px;cursor:pointer;font-size:.8em}.delete-btn[_ngcontent-%COMP%]{background:#f44;color:#fff;border:none;padding:5px 10px;border-radius:4px;cursor:pointer;font-size:.8em}.convert-btn[_ngcontent-%COMP%]:hover, .delete-btn[_ngcontent-%COMP%]:hover{opacity:.9}.btn-cancel[_ngcontent-%COMP%]{background-color:#f5f5f5;border:1px solid #ddd;color:#333;padding:8px 16px;border-radius:4px;cursor:pointer;transition:background-color .2s}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:#e9e9e9}"]})};var ve=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=w({type:r,selectors:[["app-home"]],decls:4,vars:0,consts:[[1,"dashboard-container"],[1,"dashboard-content"]],template:function(e,n){e&1&&(s(0,"div",0)(1,"div",1),D(2,"app-image-upload")(3,"app-image-gallery"),a()())},dependencies:[Q,K],styles:[".dashboard-container[_ngcontent-%COMP%]{margin-bottom:20px}.dashboard-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}@media (min-width: 768px){.dashboard-content[_ngcontent-%COMP%]{gap:30px}}"]})};export{ve as Home};
